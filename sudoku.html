<html><script>
/*
 * Prototype for solving a sudoku using simple backtracking. Backtracking tries all valid values - this strategy could be refined by propagating correct values forward and only try those.
 */

// global field to solve.
field = new Array();
for (var i=0;i<9;i++) {
	field[i] = new Array();
	for (var j=0;j<9;j++) {
		field[i][j] = 0;
	}
}

// init a sudoku (found on the net)
field[0][1] = 2;
field[0][6] = 8;
field[0][8] = 3;

field[1][0] = 4;
field[1][2] = 6;
field[1][4] = 3;
field[1][5] = 2;

field[2][0] = 3;
field[2][1] = 1;
field[2][4] = 4;
field[2][5] = 8;
field[2][7] = 9;

field[3][1] = 7;
field[3][2] = 8;
field[3][5] = 3;
field[3][6] = 4;
field[3][7] = 5;

field[4][2] = 2;
field[4][4] = 1;
field[4][8] = 8;

field[5][0] = 1;
field[5][3] = 8;
field[5][5] = 6;
field[5][8] = 9;

field[6][5] = 9;
field[6][6] = 6;

field[7][4] = 7;

field[8][0] = 5;
field[8][1] = 6;
field[8][7] = 7;

showIt();
var ok = solve(0,0,1,1);
if (ok==true)
	showIt();
else {
	alert("unsolvable!");
}



function solve(i,j,value,level) {
	if (value > 9 || value < 1) return false; // no suitable number found.

	var isOk = false;
	var rowChange = i == 8;
	var nextI = rowChange ? 0 : i + 1;
	var nextJ = rowChange ? j + 1 : j;

	// check if field has been filled already (set by default)
	// Note: it's assumed pre-filled fields are valid, so no checks are made.
	if (field[i][j] > 0 && j < 8 && i < 8) {
		return solve(nextI,nextJ,1, level + 1); // skip already solved fields.
	} else if (field[i][j] > 0 && j == 8 && i ==8) {
		return true; // solved! - special case last field is set.
	} 

	// try next value
	else if (check(value,i,j)) {
		field[i][j] = value; // save value
		if (j==8 && i ==8) return true; // solved!
		// could work -- start solving the next field
		isOk = solve(nextI, nextJ, 1, level + 1);
	}

	// path solves the sudoku
	if (isOk) return true; // this path has been solved, return result back

	// erase this path and try another value.
	field[i][j] = 0;

	isOk = solve(i,j, value + 1, level + 1);
	
	return isOk;
}

/*
 * Checks the validity of a given value at position oi/oj.
 */
function check(value, oi,oj) {
	// check row
	for (i=0;i<9;i++)
		if (value == field[i][oj]) return false;
	

	// check column
	for (j=0;j<9;j++)
		if (value == field[oi][j]) 
			
		    return false;

	// check field
	var startX = parseInt(oi / 3) * 3;
	var startY = parseInt(oj / 3) * 3;
	for (x = startX;x<startX + 3;x++)
		for (y=startY;y<startY + 3;y++)
			if (field[x][y] == value)
			
				return false; 
	
	return true;
}

/* Hint: The solution is printed into the console. */
function showIt() {
	var row = "...";
	for (var i=0;i<9;i++) {
		console.log("------  ------   ------ ")

		row = "";
		for (var j=0;j<9;j++) {
			var sep = (j+1)%3 ? "," : " | ";
			row += field[i][j] + sep;
		}
		console.log(row);


	}
	console.log("------------------------")

}

</script></html>
